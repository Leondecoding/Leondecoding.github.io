---
layout: default
---

<div class="container product-page product-page--{{ page.collection }}{% if page.collection == 'cards' or page.collection == 'artprints' %} product-page--card{% endif %}">
  <div class="product-grid" style="display:grid;grid-template-columns:minmax(260px,1fr) minmax(360px,1fr);gap:90px;align-items:start;padding-left:30px;">

       <!-- 左：主图 + 下方三张小图（支持点击放大） -->
    <div class="product-gallery">
      {%- assign main_image = page.image
            | default: page.featured_image
            | default: page.images[0] -%}
      {%- assign main_image_url = main_image | default: '' -%}

      {%- if main_image -%}
        <figure class="product-gallery__main">
          <img
            src="{{ main_image | relative_url }}"
            alt="{{ page.title }}"
            loading="lazy"
            class="js-lightbox-trigger"
            data-lightbox-src="{{ main_image | relative_url }}"
          >
        </figure>
      {%- endif -%}

      {%- if page.extra_images -%}
        <div class="product-gallery__thumbs">
          {%- for img in page.extra_images -%}
            <figure class="product-gallery__thumb">
              <img
                src="{{ img | relative_url }}"
                alt="{{ page.title }} detail {{ forloop.index }}"
                loading="lazy"
                class="js-lightbox-trigger"
                data-lightbox-src="{{ img | relative_url }}"
              >
            </figure>
          {%- endfor -%}
        </div>
      {%- endif -%}
    </div>

    <!-- 右：信息栏（标题 → 价格 → Taxes → 按钮 → 说明） -->
    <div class="product-info fz-product">
      {% assign file_display = main_image_url | split: '/' | last %}
      {% if file_display == '' or file_display == nil %}{% assign file_display = page.title %}{% endif %}
      <h1 class="product-title" style="margin:0 0 8px 0;">{{ file_display }}</h1>

      {% assign price_raw = page.price | default: page.price_gbp | default: page.priceGBP | default: page.amount | default: page.cost | default: page.Price %}
      {% assign currency_code = page.currency | default: site.currency | default: 'GBP' %}
      {% assign curr = currency_code | upcase %}
      {% assign sym = '' %}
      {% if curr == 'GBP' %}{% assign sym = '£' %}{% elsif curr == 'USD' %}{% assign sym = '$' %}{% elsif curr == 'EUR' %}{% assign sym = '€' %}{% elsif curr == 'CNY' or curr == 'JPY' %}{% assign sym = '¥' %}{% elsif curr == 'HKD' %}{% assign sym = 'HK$' %}{% elsif curr == 'TWD' %}{% assign sym = 'NT$' %}{% endif %}

      {% if price_raw %}
        <div class="product-price" style="font-size:1.125rem;margin:0 0 6px 0;float:none;clear:both;text-align:left;">
          {% if sym != '' %}{{ sym }}{{ price_raw }}{% else %}{{ price_raw }}{% if curr %} {{ curr }}{% endif %}{% endif %}
        </div>
      {% endif %}

      <div class="product-taxes" style="color:#555;margin:0 0 12px 0;float:none;clear:both;text-align:left;">Taxes included.</div>

      {% assign default_size = page.selected_size | default: page.size | default: 'A4' %}
      {% assign sku_base = page.sku | default: page.slug | default: page.title | slugify %}

      <div class="product-actions" style="display:flex;flex-direction:column;gap:8px;max-width:420px;float:none;clear:both;text-align:left;">

        <!-- PayPal：有账号就真跳 PayPal；没账号就弹提示 -->
        {% assign _biz = site.paypal_business | default: '' %}
        {% if _biz != '' %}
        <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank" style="margin:0;">
          <input type="hidden" name="cmd" value="_xclick">
          <input type="hidden" name="business" value="{{ _biz }}">
          <input type="hidden" name="item_name" value="{{ page.title | default: file_display }}">
          {% if price_raw %}<input type="hidden" name="amount" value="{{ price_raw }}">{% endif %}
          <input type="hidden" name="currency_code" value="{{ currency_code }}">
          <input type="hidden" name="on0" value="Size">
          <input type="hidden" name="os0" value="{{ default_size }}">
          <button type="submit" style="width:100%;padding:12px 16px;">Pay via PayPal</button>
        </form>
        {% else %}
        <button type="button" onclick="alert('PayPal 尚未配置。请先加入购物篮，等账号就绪后统一结账。')" style="width:100%;padding:12px 16px;">Pay via PayPal</button>
        {% endif %}

        <!-- Add to Cart：按 fz-ui.js 协议；并提供兜底入栏 -->
        <form class="product-cart" onsubmit="return false;">
          <!-- 供 getSelectedValue() 读取尺寸（隐藏，不改视觉） -->
          <input type="radio" name="size" value="{{ default_size }}" checked hidden>
          <button
            type="button"
            id="btn-add-to-cart"
            class="js-add-to-cart"
            data-title="{{ page.title | default: file_display | escape }}"
            {% if price_raw %}data-price="{{ price_raw }}"{% endif %}
            data-currency="{{ currency_code }}"
            data-image="{{ main_image_url | relative_url }}"
            data-sku="{{ sku_base }}"
            data-option-input="size"
            data-option-name="Size"
            style="width:100%;padding:12px 16px;"
          >Add to Cart</button>
        </form>
      </div>

      <!-- 作品说明 -->
      <div class="product-description" style="margin-top:16px;max-width:65ch;">{{ content }}</div>
    </div>

  </div>
</div>
<!-- 产品图片放大预览 Lightbox -->
<div id="fz-lightbox" class="fz-lightbox" aria-hidden="true">
  <button type="button" class="fz-lightbox__close" aria-label="Close">&times;</button>
  <div class="fz-lightbox__img-wrap">
    <img src="" alt="">
  </div>
</div>

<!-- ========= 本页极小兜底：若 fz-ui.js 没绑定，也能入栏/开抽屉/更新角标 ========= -->
<script>
(function(){
  function ready(fn){ if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',fn);} else {fn();} }
  function $(s,root){ return (root||document).querySelector(s); }
  function $all(s,root){ return Array.from((root||document).querySelectorAll(s)); }

  // storage helpers
  var KEY='fz_cart';
  function load(){ try{ return JSON.parse(localStorage.getItem(KEY)||'[]'); }catch(e){ return []; } }
  function save(a){ localStorage.setItem(KEY, JSON.stringify(a)); }
  function badge(){
    var b = $('#fz-cart-count'); if(!b) return;
    var n = load().reduce(function(m,i){ return m + (i.qty||1); }, 0);
    b.textContent = String(n); b.hidden = n<=0;
  }
  function getOpt(btn){
    var name = btn.dataset.optionInput || 'size';
    var wrap = btn.closest('.fz-product') || document;
    var el = wrap.querySelector('input[name="'+name+'"]:checked');
    return el ? el.value : '';
  }
  function openDrawer(){
    var d = $('#fz-cart-drawer'); if(d) d.hidden = false;
  }
  function closeDrawer(){
    var d = $('#fz-cart-drawer'); if(d) d.hidden = true;
  }
  function renderDrawer(){
    var box = $('#fz-cart-content'); if(!box) return;
    var items = load();
    if(!items.length){ box.innerHTML = '<p>当前为空。</p>'; return; }
    var total=0;
    box.innerHTML = items.map(function(it){
      var p = parseFloat(it.price)||0, q = it.qty||1; total += p*q;
      var opt = (it.options && it.options[0]) ? ' <span style="color:#666;font-size:.9em;">('+it.options[0].name+': '+it.options[0].value+')</span>' : '';
      return '<div style="display:grid;grid-template-columns:64px 1fr auto;gap:12px;align-items:center;">'
        + (it.image?('<img src="'+it.image+'" alt="" style="width:64px;height:64px;object-fit:cover;border:1px solid #eee;">'):'<div style="width:64px;height:64px;background:#f4f4f4"></div>')
        + '<div><div style="font-weight:600;">'+it.title+'</div>'+opt+'</div>'
        + '<div style="font-weight:600;">'+(it.currency==='GBP'?'£':it.currency==='USD'?'$':it.currency==='EUR'?'€':'')+(p.toFixed?p.toFixed(2):p)+' × '+q+'</div>'
        + '</div>';
    }).join('') + '<hr style="margin:12px 0;"><div style="display:flex;justify-content:space-between;font-weight:700;"><span>Total</span><span>'
      + (items[0]&&items[0].currency==='GBP'?'£':items[0]&&items[0].currency==='USD'?'$':items[0]&&items[0].currency==='EUR'?'€':'')
      + (total.toFixed? total.toFixed(2): total) + '</span></div>';
  }

  ready(function(){
        // 产品图片 Lightbox（点击主图或小图放大）
    var lb = $('#fz-lightbox');
    if (lb) {
      var lbImg   = lb.querySelector('img');
      var lbClose = lb.querySelector('.fz-lightbox__close');

      function openLightbox(src, alt){
        if (!lbImg) return;
        lbImg.src = src;
        lbImg.alt = alt || '';
        lb.setAttribute('aria-hidden', 'false');
      }

      function closeLightbox(){
        lb.setAttribute('aria-hidden', 'true');
      }

      // 点击背景关闭
      lb.addEventListener('click', function(e){
        if (e.target === lb) closeLightbox();
      });
      // 右上角 × 关闭
      if (lbClose) lbClose.addEventListener('click', closeLightbox);

      // ESC 键关闭
      document.addEventListener('keydown', function(e){
        if (e.key === 'Escape') closeLightbox();
      });

      // 绑定所有可点击的预览图 / 小图
      $all('.js-lightbox-trigger').forEach(function(img){
        img.style.cursor = 'zoom-in';
        img.addEventListener('click', function(){
          var src = img.getAttribute('data-lightbox-src') || img.src;
          var alt = img.getAttribute('alt') || '';
          openLightbox(src, alt);
        });
      });
    }
    // Add to Cart — 如果 fz-ui.js 未绑定，则本页接管
    var btn = $('#btn-add-to-cart');
    if (btn && !btn._fzWired) {
      btn.addEventListener('click', function(){
        var optName = btn.dataset.optionName || 'Size';
        var optVal  = getOpt(btn);
        var item = {
          sku: (btn.dataset.sku||'item') + (optVal?('-'+optVal):''),
          title: (btn.dataset.title||'Artwork') + (optVal?(' - '+optVal):''),
          price: parseFloat(btn.dataset.price||'0'),
          currency: btn.dataset.currency || 'GBP',
          image: btn.dataset.image || '',
          qty: 1,
          options: optVal ? [{ name: optName, value: optVal }] : []
        };
        var cart = load();
        var exist = cart.find(function(x){ return x.sku === item.sku; });
        if (exist) exist.qty = (exist.qty||1)+1; else cart.push(item);
        save(cart); badge();

        var old = btn.textContent; btn.disabled=true; btn.textContent='Added ✓';
        setTimeout(function(){ btn.textContent=old; btn.disabled=false; }, 900);
      });
      btn._fzWired = true;
    }

    // 右上角按钮兜底（如果全站 JS 没接上）
    var sBtn = $('#fz-search-btn'), lBtn = $('#fz-login-btn'), cBtn = $('#fz-cart-btn');
    if (sBtn) sBtn.addEventListener('click', function(){ var p=$('#fz-search-panel'); if(p) p.hidden=false; });
    $all('[data-close="fz-search-panel"]').forEach(function(x){ x.addEventListener('click', function(){ var p=$('#fz-search-panel'); if(p) p.hidden=true; }); });
    if (lBtn) lBtn.addEventListener('click', function(e){ e.stopPropagation(); var m=$('#fz-login-menu'); if(!m) return; var open=m.hidden; m.hidden=!open; lBtn.setAttribute('aria-expanded', String(open)); });
    document.addEventListener('click', function(e){ var m=$('#fz-login-menu'); if(m && !m.hidden && !m.contains(e.target) && e.target!==lBtn){ m.hidden=true; lBtn && lBtn.setAttribute('aria-expanded','false'); } });
    if (cBtn) cBtn.addEventListener('click', function(){ renderDrawer(); openDrawer(); });
    $all('[data-close="fz-cart-drawer"]').forEach(function(x){ x.addEventListener('click', closeDrawer); });

    badge(); // 初始角标
  });
})();
</script>
